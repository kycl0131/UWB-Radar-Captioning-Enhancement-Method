Epoch 1/200: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:49<00:00,  1.16s/it, loss=0.525]
Epoch 1/200, Train Loss: 0.5252, Train_acc: 0.4655, Val Loss: 1.2105, Val_acc: 0.3337
Epoch 2/200: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:47<00:00,  1.14s/it, loss=0.393]
Epoch 2/200, Train Loss: 0.3934, Train_acc: 0.7448, Val Loss: 0.8900, Val_acc: 0.5997
Epoch 3/200: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:50<00:00,  1.18s/it, loss=0.255]
Epoch 3/200, Train Loss: 0.2553, Train_acc: 0.8945, Val Loss: 0.9492, Val_acc: 0.5658
Epoch 4/200: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:48<00:00,  1.15s/it, loss=0.181]
Epoch 4/200, Train Loss: 0.1808, Train_acc: 0.9454, Val Loss: 0.9913, Val_acc: 0.5683
Epoch 5/200: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:53<00:00,  1.21s/it, loss=0.138]
Epoch 5/200, Train Loss: 0.1384, Train_acc: 0.9663, Val Loss: 1.0157, Val_acc: 0.5817
Epoch 6/200: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:47<00:00,  1.14s/it, loss=0.112]
Epoch 6/200, Train Loss: 0.1118, Train_acc: 0.9778, Val Loss: 1.0102, Val_acc: 0.5698
Epoch 7/200: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:51<00:00,  1.19s/it, loss=0.0957]
Epoch 7/200, Train Loss: 0.0957, Train_acc: 0.9847, Val Loss: 1.0338, Val_acc: 0.5808
Epoch 8/200: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:52<00:00,  1.20s/it, loss=0.0796]
Epoch 8/200, Train Loss: 0.0796, Train_acc: 0.9895, Val Loss: 1.0147, Val_acc: 0.5983
Epoch 9/200: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:48<00:00,  1.16s/it, loss=0.0736]
Epoch 9/200, Train Loss: 0.0736, Train_acc: 0.9918, Val Loss: 1.0552, Val_acc: 0.5942
Epoch 10/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:50<00:00,  1.18s/it, loss=0.0684]
Epoch 10/200, Train Loss: 0.0684, Train_acc: 0.9935, Val Loss: 1.0464, Val_acc: 0.5962
Epoch 11/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:47<00:00,  1.14s/it, loss=0.0574]
Epoch 11/200, Train Loss: 0.0574, Train_acc: 0.9946, Val Loss: 1.0640, Val_acc: 0.5928
Epoch 12/200: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:52<00:00,  1.20s/it, loss=0.058]
Epoch 12/200, Train Loss: 0.0580, Train_acc: 0.9965, Val Loss: 1.1662, Val_acc: 0.5868
Epoch 13/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:49<00:00,  1.16s/it, loss=0.0491]
Epoch 13/200, Train Loss: 0.0491, Train_acc: 0.9970, Val Loss: 1.1157, Val_acc: 0.5952
Epoch 14/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:52<00:00,  1.20s/it, loss=0.0458]
Epoch 14/200, Train Loss: 0.0458, Train_acc: 0.9976, Val Loss: 1.1007, Val_acc: 0.6015
Epoch 15/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:50<00:00,  1.17s/it, loss=0.0456]
Epoch 15/200, Train Loss: 0.0456, Train_acc: 0.9981, Val Loss: 1.0933, Val_acc: 0.5997
Epoch 16/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:53<00:00,  1.20s/it, loss=0.0509]
Epoch 16/200, Train Loss: 0.0509, Train_acc: 0.9977, Val Loss: 1.0337, Val_acc: 0.6200
Epoch 17/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:48<00:00,  1.16s/it, loss=0.0447]
Epoch 17/200, Train Loss: 0.0447, Train_acc: 0.9982, Val Loss: 1.0433, Val_acc: 0.6125
Epoch 18/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:49<00:00,  1.16s/it, loss=0.0449]
Epoch 18/200, Train Loss: 0.0449, Train_acc: 0.9976, Val Loss: 1.1845, Val_acc: 0.5977
Epoch 19/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:49<00:00,  1.17s/it, loss=0.0403]
Epoch 19/200, Train Loss: 0.0403, Train_acc: 0.9985, Val Loss: 1.1770, Val_acc: 0.6015
Epoch 20/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:49<00:00,  1.16s/it, loss=0.0443]
Epoch 20/200, Train Loss: 0.0443, Train_acc: 0.9983, Val Loss: 1.1400, Val_acc: 0.6082
Epoch 21/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:51<00:00,  1.18s/it, loss=0.0399]
Epoch 21/200, Train Loss: 0.0399, Train_acc: 0.9982, Val Loss: 1.0129, Val_acc: 0.6443
Epoch 22/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:51<00:00,  1.19s/it, loss=0.0435]
Epoch 22/200, Train Loss: 0.0435, Train_acc: 0.9989, Val Loss: 1.1131, Val_acc: 0.6172
Epoch 23/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:51<00:00,  1.18s/it, loss=0.0343]
Epoch 23/200, Train Loss: 0.0343, Train_acc: 0.9990, Val Loss: 1.1347, Val_acc: 0.6302
Epoch 24/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:53<00:00,  1.20s/it, loss=0.0284]
Epoch 24/200, Train Loss: 0.0284, Train_acc: 0.9995, Val Loss: 1.2142, Val_acc: 0.6185
Epoch 25/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:49<00:00,  1.16s/it, loss=0.0269]
Epoch 25/200, Train Loss: 0.0269, Train_acc: 0.9997, Val Loss: 1.1784, Val_acc: 0.6272
Epoch 26/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:51<00:00,  1.19s/it, loss=0.0255]
Epoch 26/200, Train Loss: 0.0255, Train_acc: 0.9994, Val Loss: 1.1581, Val_acc: 0.6352
Epoch 27/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:50<00:00,  1.17s/it, loss=0.0285]
Epoch 27/200, Train Loss: 0.0285, Train_acc: 0.9998, Val Loss: 1.2293, Val_acc: 0.6228
Epoch 28/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:54<00:00,  1.22s/it, loss=0.0293]
Epoch 28/200, Train Loss: 0.0293, Train_acc: 0.9995, Val Loss: 1.1857, Val_acc: 0.6330
Epoch 29/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:50<00:00,  1.17s/it, loss=0.0265]
Epoch 29/200, Train Loss: 0.0265, Train_acc: 0.9995, Val Loss: 1.1897, Val_acc: 0.6332
Epoch 30/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:52<00:00,  1.20s/it, loss=0.0318]
Epoch 30/200, Train Loss: 0.0318, Train_acc: 0.9990, Val Loss: 1.1822, Val_acc: 0.6188
Epoch 31/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:51<00:00,  1.19s/it, loss=0.0228]
Epoch 31/200, Train Loss: 0.0228, Train_acc: 0.9997, Val Loss: 1.2539, Val_acc: 0.6083
Epoch 32/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:52<00:00,  1.20s/it, loss=0.0216]
Epoch 32/200, Train Loss: 0.0216, Train_acc: 0.9996, Val Loss: 1.2593, Val_acc: 0.6200
Epoch 33/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:50<00:00,  1.18s/it, loss=0.0193]
Epoch 33/200, Train Loss: 0.0193, Train_acc: 0.9998, Val Loss: 1.2988, Val_acc: 0.6347
Epoch 34/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:56<00:00,  1.24s/it, loss=0.0239]
Epoch 34/200, Train Loss: 0.0239, Train_acc: 0.9997, Val Loss: 1.3397, Val_acc: 0.6373
Epoch 35/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:54<00:00,  1.22s/it, loss=0.0223]
Epoch 35/200, Train Loss: 0.0223, Train_acc: 0.9995, Val Loss: 1.2577, Val_acc: 0.6480
Epoch 36/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:52<00:00,  1.20s/it, loss=0.0177]
Epoch 36/200, Train Loss: 0.0177, Train_acc: 0.9997, Val Loss: 1.3792, Val_acc: 0.6140
Epoch 37/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:49<00:00,  1.17s/it, loss=0.0115]
Epoch 37/200, Train Loss: 0.0115, Train_acc: 1.0000, Val Loss: 1.3966, Val_acc: 0.6325
Epoch 38/200: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:52<00:00,  1.20s/it, loss=0.011]
Epoch 38/200, Train Loss: 0.0110, Train_acc: 1.0000, Val Loss: 1.5941, Val_acc: 0.6342
Epoch 39/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:50<00:00,  1.18s/it, loss=0.00721]
Epoch 39/200, Train Loss: 0.0072, Train_acc: 1.0000, Val Loss: 1.5720, Val_acc: 0.6382
Epoch 40/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:53<00:00,  1.21s/it, loss=0.00716]
Epoch 40/200, Train Loss: 0.0072, Train_acc: 1.0000, Val Loss: 1.6027, Val_acc: 0.6510
Epoch 41/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:50<00:00,  1.17s/it, loss=0.0126]
Epoch 41/200, Train Loss: 0.0126, Train_acc: 0.9998, Val Loss: 1.6822, Val_acc: 0.6598
Epoch 42/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:50<00:00,  1.17s/it, loss=0.0223]
Epoch 42/200, Train Loss: 0.0223, Train_acc: 0.9997, Val Loss: 1.9351, Val_acc: 0.6143
Epoch 43/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:49<00:00,  1.16s/it, loss=0.0388]
Epoch 43/200, Train Loss: 0.0388, Train_acc: 0.9985, Val Loss: 1.9018, Val_acc: 0.6123
Epoch 44/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:51<00:00,  1.19s/it, loss=0.0342]
Epoch 44/200, Train Loss: 0.0342, Train_acc: 0.9989, Val Loss: 2.1342, Val_acc: 0.6140
Epoch 45/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:51<00:00,  1.18s/it, loss=0.0195]
Epoch 45/200, Train Loss: 0.0195, Train_acc: 0.9995, Val Loss: 2.3436, Val_acc: 0.6265
Epoch 46/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:52<00:00,  1.19s/it, loss=0.0101]
Epoch 46/200, Train Loss: 0.0101, Train_acc: 0.9999, Val Loss: 2.4690, Val_acc: 0.6178
Epoch 47/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:49<00:00,  1.16s/it, loss=0.00424]
Epoch 47/200, Train Loss: 0.0042, Train_acc: 1.0000, Val Loss: 2.5939, Val_acc: 0.6158
Epoch 48/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:50<00:00,  1.17s/it, loss=0.00274]
Epoch 48/200, Train Loss: 0.0027, Train_acc: 1.0000, Val Loss: 2.6389, Val_acc: 0.6160
Epoch 49/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:49<00:00,  1.17s/it, loss=0.00238]
Epoch 49/200, Train Loss: 0.0024, Train_acc: 1.0000, Val Loss: 2.6545, Val_acc: 0.6215
Epoch 50/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:51<00:00,  1.18s/it, loss=0.00209]
Epoch 50/200, Train Loss: 0.0021, Train_acc: 1.0000, Val Loss: 2.7456, Val_acc: 0.6182
Epoch 51/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:50<00:00,  1.17s/it, loss=0.0017]
Epoch 51/200, Train Loss: 0.0017, Train_acc: 1.0000, Val Loss: 2.7673, Val_acc: 0.6180
Epoch 52/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:52<00:00,  1.20s/it, loss=0.00146]
Epoch 52/200, Train Loss: 0.0015, Train_acc: 1.0000, Val Loss: 2.8176, Val_acc: 0.6157
Epoch 53/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:48<00:00,  1.16s/it, loss=0.00143]
Epoch 53/200, Train Loss: 0.0014, Train_acc: 1.0000, Val Loss: 2.8332, Val_acc: 0.6143
Epoch 54/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:51<00:00,  1.18s/it, loss=0.00129]
Epoch 54/200, Train Loss: 0.0013, Train_acc: 1.0000, Val Loss: 2.8359, Val_acc: 0.6183
Epoch 55/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:52<00:00,  1.20s/it, loss=0.00121]
Epoch 55/200, Train Loss: 0.0012, Train_acc: 1.0000, Val Loss: 2.8749, Val_acc: 0.6170
Epoch 56/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:53<00:00,  1.21s/it, loss=0.00124]
Epoch 56/200, Train Loss: 0.0012, Train_acc: 1.0000, Val Loss: 2.8631, Val_acc: 0.6157
Epoch 57/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:54<00:00,  1.21s/it, loss=0.00123]
Epoch 57/200, Train Loss: 0.0012, Train_acc: 1.0000, Val Loss: 2.8535, Val_acc: 0.6168
Epoch 58/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:52<00:00,  1.19s/it, loss=0.00118]
Epoch 58/200, Train Loss: 0.0012, Train_acc: 1.0000, Val Loss: 2.8713, Val_acc: 0.6172
Epoch 59/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 94/94 [01:49<00:00,  1.16s/it, loss=0.00115]
Epoch 59/200, Train Loss: 0.0012, Train_acc: 1.0000, Val Loss: 2.8905, Val_acc: 0.6117
Epoch 60/200:  26%|█████████████████████████████████▋                                                                                                  | 24/94 [00:28<01:22,  1.17s/it, loss=0.0011]
Traceback (most recent call last):
  File "/home/yunkwan/project/radarclip/distillation.py", line 391, in <module>
    main(args.train_3, args.epochs, args.batch_size, args.test_mode)
  File "/home/yunkwan/project/radarclip/distillation.py", line 376, in main
    train_model(teacher_model, student_model, retrieval_model,train_loader, val_loader, criterion, optimizer, warmup_scheduler, cosine_scheduler, prepro_image_fn=prepro_image_features, num_epochs=num_epochs, filter=LearnableLogFilter_3)
  File "/home/yunkwan/project/radarclip/distillation.py", line 175, in train_model
    for images, radars, _, _, labels in train_loader_tqdm:
  File "/home/yunkwan/anaconda3/envs/smallcap/lib/python3.9/site-packages/tqdm/std.py", line 1195, in __iter__
    for obj in iterable:
  File "/home/yunkwan/anaconda3/envs/smallcap/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 631, in __next__
    data = self._next_data()
  File "/home/yunkwan/anaconda3/envs/smallcap/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 675, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/yunkwan/anaconda3/envs/smallcap/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/yunkwan/anaconda3/envs/smallcap/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/yunkwan/project/radarclip/dataload.py", line 105, in __getitem__
    image = Image.open(image_path).convert('RGB')
  File "/home/yunkwan/anaconda3/envs/smallcap/lib/python3.9/site-packages/PIL/Image.py", line 3318, in open
    im = _open_core(fp, filename, prefix, formats)
  File "/home/yunkwan/anaconda3/envs/smallcap/lib/python3.9/site-packages/PIL/Image.py", line 3299, in _open_core
    result = not accept or accept(prefix)
  File "/home/yunkwan/anaconda3/envs/smallcap/lib/python3.9/site-packages/PIL/JpegImagePlugin.py", line 349, in _accept
    return prefix[:3] == b"\xFF\xD8\xFF"
KeyboardInterrupt
