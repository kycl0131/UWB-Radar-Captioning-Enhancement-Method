Some weights of SmallCap were not initialized from the model checkpoint at Yova/SmallCap7M and are newly initialized: ['encoder_radar.layer4.0.bn1.bias', 'encoder_radar.layer3.22.conv1.weight', 'encoder_radar.layer1.0.bn2.running_var', 'encoder_radar.layer3.1.bn1.running_var', 'encoder_radar.layer1.1.bn2.running_mean', 'encoder_radar.layer2.2.bn1.running_var', 'encoder_radar.layer1.1.bn3.bias', 'encoder_radar.layer4.2.bn2.running_var', 'encoder_radar.layer2.2.conv1.weight', 'encoder_radar.layer3.1.bn1.bias', 'encoder_radar.layer3.0.downsample.1.running_var', 'encoder_radar.layer3.16.bn3.bias', 'encoder_radar.layer3.0.bn2.running_mean', 'encoder_radar.layer3.10.bn1.num_batches_tracked', 'encoder_radar.layer3.19.conv2.weight', 'encoder_radar.layer3.20.bn1.num_batches_tracked', 'encoder_radar.layer3.11.bn2.weight', 'encoder_radar.bn1.num_batches_tracked', 'encoder_radar.layer3.10.bn1.running_mean', 'encoder_radar.layer2.3.bn1.bias', 'encoder_radar.layer4.2.bn2.num_batches_tracked', 'encoder_radar.layer3.14.bn1.num_batches_tracked', 'encoder_radar.layer3.14.bn3.bias', 'encoder_radar.layer3.0.bn3.running_var', 'encoder_radar.layer3.18.conv3.weight', 'encoder_radar.layer3.4.bn3.running_mean', 'encoder_radar.layer3.20.bn3.running_var', 'encoder_radar.layer2.2.bn2.running_var', 'encoder_radar.layer3.6.bn2.num_batches_tracked', 'encoder_radar.layer3.12.bn3.running_var', 'encoder_radar.layer3.21.conv1.weight', 'encoder_radar.layer3.17.bn3.bias', 'encoder_radar.layer3.8.conv3.weight', 'encoder_radar.layer3.8.bn1.num_batches_tracked', 'encoder_radar.layer3.6.bn2.bias', 'encoder_radar.layer1.2.bn1.running_var', 'encoder_radar.layer3.13.bn3.weight', 'encoder_radar.layer3.4.bn2.weight', 'encoder_radar.layer3.11.bn2.bias', 'encoder_radar.layer3.15.bn2.bias', 'encoder_radar.layer3.5.bn3.running_var', 'encoder_radar.layer3.10.conv3.weight', 'encoder_radar.layer2.2.bn2.weight', 'encoder_radar.layer4.0.downsample.0.weight', 'encoder_radar.layer2.0.downsample.1.running_var', 'encoder_radar.layer4.1.bn3.num_batches_tracked', 'encoder_radar.layer3.15.conv3.weight', 'encoder_radar.layer1.1.bn1.num_batches_tracked', 'encoder_radar.layer1.1.bn2.weight', 'encoder_radar.layer2.1.bn1.running_var', 'encoder_radar.layer1.1.bn1.bias', 'encoder_radar.layer3.13.conv2.weight', 'encoder_radar.layer3.11.bn1.running_var', 'encoder_radar.layer3.0.bn1.num_batches_tracked', 'encoder_radar.layer3.16.bn1.running_var', 'encoder_radar.layer3.16.bn3.running_mean', 'encoder_radar.layer3.8.bn3.running_var', 'encoder_radar.layer3.9.bn2.running_mean', 'encoder_radar.layer3.0.downsample.1.running_mean', 'encoder_radar.layer3.17.bn1.bias', 'encoder_radar.layer3.10.bn1.bias', 'encoder_radar.layer1.1.bn3.num_batches_tracked', 'encoder_radar.layer4.0.bn3.running_var', 'encoder_radar.layer1.0.bn1.num_batches_tracked', 'encoder_radar.layer2.0.bn2.running_mean', 'encoder_radar.layer3.12.conv2.weight', 'encoder_radar.layer3.11.bn3.bias', 'encoder_radar.layer3.15.bn2.running_mean', 'encoder_radar.layer2.1.bn1.running_mean', 'encoder_radar.layer3.4.bn2.running_mean', 'encoder_radar.layer3.14.bn1.weight', 'encoder_radar.layer3.1.bn2.running_mean', 'encoder_radar.layer2.0.conv2.weight', 'encoder_radar.layer2.0.downsample.1.weight', 'encoder_radar.layer2.2.bn3.num_batches_tracked', 'encoder_radar.layer2.3.bn3.bias', 'encoder_radar.layer3.0.bn2.weight', 'encoder_radar.layer3.7.bn3.running_mean', 'encoder_radar.layer3.12.bn3.running_mean', 'encoder_radar.layer4.0.downsample.1.running_mean', 'encoder_radar.layer3.16.bn2.running_var', 'encoder_radar.layer2.0.downsample.1.bias', 'encoder_radar.layer2.3.bn1.num_batches_tracked', 'encoder_radar.layer3.22.bn1.weight', 'encoder_radar.layer3.14.bn3.running_var', 'encoder_radar.layer2.3.bn2.running_var', 'encoder_radar.layer3.13.bn3.num_batches_tracked', 'encoder_radar.layer1.2.bn2.weight', 'encoder_radar.layer3.9.bn1.running_mean', 'encoder_radar.layer3.1.conv3.weight', 'encoder_radar.layer3.22.conv2.weight', 'encoder_radar.fc.bias', 'encoder_radar.layer3.4.bn2.bias', 'encoder_radar.layer3.2.bn1.bias', 'encoder_radar.layer2.2.bn3.running_mean'
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Epoch 1/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 375/375 [02:35<00:00,  2.41it/s, loss=0.373]
Epoch 1/100, Train Loss: 0.3730, Train_acc: 0.7258, Val Loss: 0.6892, Val_acc: 0.7228
Epoch 2/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 375/375 [02:35<00:00,  2.42it/s, loss=0.258]
Epoch 2/100, Train Loss: 0.2584, Train_acc: 0.8622, Val Loss: 0.6981, Val_acc: 0.7213
Epoch 3/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 375/375 [02:33<00:00,  2.44it/s, loss=0.23]
Epoch 3/100, Train Loss: 0.2304, Train_acc: 0.8825, Val Loss: 0.6875, Val_acc: 0.7513
Epoch 4/100:  74%|██████████████████████████████████████████████████████████████████████████████████████████████████▏                                 | 279/375 [01:56<00:40,  2.40it/s, loss=0.217]
Traceback (most recent call last):
  File "/home/yunkwan/project/radarclip/distillation.py", line 372, in <module>
    test_model(StudentModel().to(device), AutoModel.from_pretrained("Yova/SmallCap7M").to(device), DataLoader(test_dataset, batch_size=args.batch_size, shuffle=True), nn.CrossEntropyLoss(), prepro_image_fn=prepro_image_features)
  File "/home/yunkwan/project/radarclip/distillation.py", line 353, in main
    warmup_scheduler = LambdaLR(optimizer, lr_lambda=warmup_lr_lambda)
  File "/home/yunkwan/project/radarclip/distillation.py", line 169, in train_model
    image_features = prepro_image_fn(images, retrieval_model, device, batch_size=32)
  File "/home/yunkwan/project/radarclip/distillation.py", line 65, in prepro_image_features
    torch.cuda.empty_cache()
  File "/home/yunkwan/anaconda3/envs/smallcap/lib/python3.9/site-packages/torch/cuda/memory.py", line 162, in empty_cache
    torch._C._cuda_emptyCache()
KeyboardInterrupt
