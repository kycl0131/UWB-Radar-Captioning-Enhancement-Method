Epoch 1/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:44<00:00,  1.14it/s, loss=0.428]
Epoch 1/200, Train Loss: 0.4280, Train_acc: 0.6550, Val Loss: 0.9596, Val_acc: 0.5823
Epoch 2/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:39<00:00,  1.18it/s, loss=0.292]
Epoch 2/200, Train Loss: 0.2921, Train_acc: 0.8425, Val Loss: 0.9407, Val_acc: 0.6265
Epoch 3/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:44<00:00,  1.14it/s, loss=0.228]
Epoch 3/200, Train Loss: 0.2283, Train_acc: 0.9087, Val Loss: 0.8778, Val_acc: 0.6235
Epoch 4/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:42<00:00,  1.16it/s, loss=0.196]
Epoch 4/200, Train Loss: 0.1958, Train_acc: 0.9346, Val Loss: 0.9088, Val_acc: 0.6243
Epoch 5/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:43<00:00,  1.15it/s, loss=0.173]
Epoch 5/200, Train Loss: 0.1726, Train_acc: 0.9493, Val Loss: 0.9641, Val_acc: 0.6293
Epoch 6/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:43<00:00,  1.15it/s, loss=0.151]
Epoch 6/200, Train Loss: 0.1511, Train_acc: 0.9609, Val Loss: 1.1590, Val_acc: 0.5510
Epoch 7/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:44<00:00,  1.14it/s, loss=0.149]
Epoch 7/200, Train Loss: 0.1487, Train_acc: 0.9651, Val Loss: 1.0556, Val_acc: 0.5853
Epoch 8/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:41<00:00,  1.16it/s, loss=0.148]
Epoch 8/200, Train Loss: 0.1482, Train_acc: 0.9661, Val Loss: 1.1450, Val_acc: 0.5767
Epoch 9/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:42<00:00,  1.16it/s, loss=0.134]
Epoch 9/200, Train Loss: 0.1336, Train_acc: 0.9715, Val Loss: 1.0140, Val_acc: 0.5882
Epoch 10/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:43<00:00,  1.15it/s, loss=0.161]
Epoch 10/200, Train Loss: 0.1611, Train_acc: 0.9643, Val Loss: 1.0895, Val_acc: 0.5868
Epoch 11/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:43<00:00,  1.15it/s, loss=0.169]
Epoch 11/200, Train Loss: 0.1694, Train_acc: 0.9569, Val Loss: 1.0509, Val_acc: 0.5635
Epoch 12/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:40<00:00,  1.17it/s, loss=0.194]
Epoch 12/200, Train Loss: 0.1945, Train_acc: 0.9477, Val Loss: 1.0983, Val_acc: 0.5323
Epoch 13/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:42<00:00,  1.16it/s, loss=0.222]
Epoch 13/200, Train Loss: 0.2222, Train_acc: 0.9360, Val Loss: 0.9384, Val_acc: 0.5918
Epoch 14/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:43<00:00,  1.15it/s, loss=0.259]
Epoch 14/200, Train Loss: 0.2589, Train_acc: 0.9260, Val Loss: 5.1801, Val_acc: 0.3337
Epoch 15/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:41<00:00,  1.16it/s, loss=0.285]
Epoch 15/200, Train Loss: 0.2855, Train_acc: 0.9034, Val Loss: 1.1104, Val_acc: 0.5273
Epoch 16/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:41<00:00,  1.17it/s, loss=0.216]
Epoch 16/200, Train Loss: 0.2163, Train_acc: 0.9406, Val Loss: 1.4898, Val_acc: 0.4635
Epoch 17/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:42<00:00,  1.16it/s, loss=0.23]
Epoch 17/200, Train Loss: 0.2302, Train_acc: 0.9401, Val Loss: 1.1503, Val_acc: 0.4908
Epoch 18/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:42<00:00,  1.16it/s, loss=0.254]
Epoch 18/200, Train Loss: 0.2541, Train_acc: 0.9195, Val Loss: 1.0884, Val_acc: 0.4918
Epoch 19/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:44<00:00,  1.14it/s, loss=0.402]
Epoch 19/200, Train Loss: 0.4020, Train_acc: 0.8562, Val Loss: 1.0448, Val_acc: 0.4800
Epoch 20/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:43<00:00,  1.15it/s, loss=0.28]
Epoch 20/200, Train Loss: 0.2802, Train_acc: 0.9158, Val Loss: 1.0866, Val_acc: 0.4730
Epoch 21/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:43<00:00,  1.15it/s, loss=0.214]
Epoch 21/200, Train Loss: 0.2138, Train_acc: 0.9473, Val Loss: 1.0060, Val_acc: 0.5723
Epoch 22/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:43<00:00,  1.15it/s, loss=0.183]
Epoch 22/200, Train Loss: 0.1831, Train_acc: 0.9535, Val Loss: 1.2766, Val_acc: 0.4780
Epoch 23/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:41<00:00,  1.16it/s, loss=0.187]
Epoch 23/200, Train Loss: 0.1872, Train_acc: 0.9578, Val Loss: 1.2033, Val_acc: 0.5235
Epoch 24/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:42<00:00,  1.16it/s, loss=0.158]
Epoch 24/200, Train Loss: 0.1585, Train_acc: 0.9645, Val Loss: 1.0847, Val_acc: 0.5172
Epoch 25/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:46<00:00,  1.13it/s, loss=0.482]
Epoch 25/200, Train Loss: 0.4823, Train_acc: 0.7510, Val Loss: 1.0148, Val_acc: 0.5115
Epoch 26/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:44<00:00,  1.15it/s, loss=0.31]
Epoch 26/200, Train Loss: 0.3097, Train_acc: 0.8720, Val Loss: 1.0359, Val_acc: 0.5382
Epoch 27/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:43<00:00,  1.15it/s, loss=0.201]
Epoch 27/200, Train Loss: 0.2005, Train_acc: 0.9477, Val Loss: 1.3320, Val_acc: 0.4615
Epoch 28/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:40<00:00,  1.17it/s, loss=0.184]
Epoch 28/200, Train Loss: 0.1839, Train_acc: 0.9558, Val Loss: 1.2602, Val_acc: 0.4665
Epoch 29/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:42<00:00,  1.16it/s, loss=0.147]
Epoch 29/200, Train Loss: 0.1472, Train_acc: 0.9675, Val Loss: 1.2218, Val_acc: 0.5198
Epoch 30/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:43<00:00,  1.15it/s, loss=0.137]
Epoch 30/200, Train Loss: 0.1367, Train_acc: 0.9702, Val Loss: 1.1900, Val_acc: 0.5540
Epoch 31/200: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:40<00:00,  1.17it/s, loss=0.13]
Epoch 31/200, Train Loss: 0.1302, Train_acc: 0.9718, Val Loss: 1.1618, Val_acc: 0.5257
Epoch 32/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:43<00:00,  1.15it/s, loss=0.134]
Epoch 32/200, Train Loss: 0.1340, Train_acc: 0.9712, Val Loss: 1.2696, Val_acc: 0.5100
Epoch 33/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:40<00:00,  1.17it/s, loss=0.123]
Epoch 33/200, Train Loss: 0.1231, Train_acc: 0.9752, Val Loss: 1.2606, Val_acc: 0.5310
Epoch 34/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:43<00:00,  1.15it/s, loss=0.113]
Epoch 34/200, Train Loss: 0.1127, Train_acc: 0.9770, Val Loss: 1.4104, Val_acc: 0.5073
Epoch 35/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:45<00:00,  1.14it/s, loss=0.105]
Epoch 35/200, Train Loss: 0.1053, Train_acc: 0.9808, Val Loss: 1.4172, Val_acc: 0.5142
Epoch 36/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:43<00:00,  1.15it/s, loss=0.125]
Epoch 36/200, Train Loss: 0.1255, Train_acc: 0.9728, Val Loss: 1.3783, Val_acc: 0.4905
Epoch 37/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:41<00:00,  1.16it/s, loss=0.107]
Epoch 37/200, Train Loss: 0.1067, Train_acc: 0.9792, Val Loss: 1.3884, Val_acc: 0.5348
Epoch 38/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:45<00:00,  1.14it/s, loss=0.105]
Epoch 38/200, Train Loss: 0.1046, Train_acc: 0.9787, Val Loss: 1.2924, Val_acc: 0.5412
Epoch 39/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:45<00:00,  1.13it/s, loss=0.131]
Epoch 39/200, Train Loss: 0.1314, Train_acc: 0.9711, Val Loss: 1.2291, Val_acc: 0.5342
Epoch 40/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:41<00:00,  1.16it/s, loss=0.138]
Epoch 40/200, Train Loss: 0.1381, Train_acc: 0.9705, Val Loss: 1.2757, Val_acc: 0.5407
Epoch 41/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:42<00:00,  1.16it/s, loss=0.146]
Epoch 41/200, Train Loss: 0.1458, Train_acc: 0.9682, Val Loss: 1.2844, Val_acc: 0.5492
Epoch 42/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:40<00:00,  1.17it/s, loss=0.121]
Epoch 42/200, Train Loss: 0.1208, Train_acc: 0.9741, Val Loss: 1.2964, Val_acc: 0.4817
Epoch 43/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:41<00:00,  1.16it/s, loss=0.133]
Epoch 43/200, Train Loss: 0.1330, Train_acc: 0.9673, Val Loss: 1.2508, Val_acc: 0.5385
Epoch 44/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:43<00:00,  1.15it/s, loss=0.128]
Epoch 44/200, Train Loss: 0.1279, Train_acc: 0.9676, Val Loss: 1.6374, Val_acc: 0.4495
Epoch 45/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:42<00:00,  1.16it/s, loss=0.162]
Epoch 45/200, Train Loss: 0.1619, Train_acc: 0.9494, Val Loss: 1.1840, Val_acc: 0.5397
Epoch 46/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:43<00:00,  1.15it/s, loss=0.205]
Epoch 46/200, Train Loss: 0.2055, Train_acc: 0.9524, Val Loss: 1.1576, Val_acc: 0.5508
Epoch 47/200: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:46<00:00,  1.13it/s, loss=0.099]
Epoch 47/200, Train Loss: 0.0990, Train_acc: 0.9807, Val Loss: 1.2965, Val_acc: 0.5292
Epoch 48/200: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:47<00:00,  1.13it/s, loss=0.0857]
Epoch 48/200, Train Loss: 0.0857, Train_acc: 0.9848, Val Loss: 1.3607, Val_acc: 0.4972
Epoch 49/200: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:43<00:00,  1.15it/s, loss=0.0791]
Epoch 49/200, Train Loss: 0.0791, Train_acc: 0.9852, Val Loss: 1.4164, Val_acc: 0.5272
Epoch 50/200: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:40<00:00,  1.17it/s, loss=0.0708]
Epoch 50/200, Train Loss: 0.0708, Train_acc: 0.9883, Val Loss: 1.3506, Val_acc: 0.5480
Epoch 51/200: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:42<00:00,  1.15it/s, loss=0.0586]
Epoch 51/200, Train Loss: 0.0586, Train_acc: 0.9909, Val Loss: 1.3740, Val_acc: 0.5578
Epoch 52/200: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:43<00:00,  1.15it/s, loss=0.0548]
Epoch 52/200, Train Loss: 0.0548, Train_acc: 0.9914, Val Loss: 1.4770, Val_acc: 0.5478
Epoch 53/200: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:44<00:00,  1.14it/s, loss=0.0497]
Epoch 53/200, Train Loss: 0.0497, Train_acc: 0.9932, Val Loss: 1.4484, Val_acc: 0.5507
Epoch 54/200:  60%|█████████████████████████████████████████████████████████████████████████████▍                                                    | 112/188 [01:39<01:07,  1.13it/s, loss=0.0492]
Traceback (most recent call last):
  File "/home/yunkwan/project/radarclip/distillation.py", line 409, in <module>
    main(args.train_3, args.epochs, args.batch_size, args.test_mode)
  File "/home/yunkwan/project/radarclip/distillation.py", line 394, in main
    train_model(teacher_model, student_model, retrieval_model,train_loader, val_loader, criterion, optimizer, warmup_scheduler, cosine_scheduler, prepro_image_fn=prepro_image_features, num_epochs=num_epochs, filter=LearnableLogFilter_3)
  File "/home/yunkwan/project/radarclip/distillation.py", line 215, in train_model
    loss.backward()
  File "/home/yunkwan/anaconda3/envs/smallcap/lib/python3.9/site-packages/torch/_tensor.py", line 525, in backward
    torch.autograd.backward(
  File "/home/yunkwan/anaconda3/envs/smallcap/lib/python3.9/site-packages/torch/autograd/__init__.py", line 267, in backward
    _engine_run_backward(
  File "/home/yunkwan/anaconda3/envs/smallcap/lib/python3.9/site-packages/torch/autograd/graph.py", line 744, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
