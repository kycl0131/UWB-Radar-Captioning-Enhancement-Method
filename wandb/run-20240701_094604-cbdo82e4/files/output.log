Epoch 1/1000: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 85/85 [04:58<00:00,  3.51s/it, loss=0.0359]
Epoch 1/1000, Train Loss: 0.0359, Val Loss: 0.0084
Epoch 2/1000: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 85/85 [04:53<00:00,  3.46s/it, loss=0.00694]
Epoch 2/1000, Train Loss: 0.0069, Val Loss: 0.0061
Epoch 3/1000: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 85/85 [04:55<00:00,  3.48s/it, loss=0.00598]
Epoch 3/1000, Train Loss: 0.0060, Val Loss: 0.0057
Epoch 4/1000: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 85/85 [04:56<00:00,  3.49s/it, loss=0.00563]
Epoch 4/1000, Train Loss: 0.0056, Val Loss: 0.0055
Epoch 5/1000: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 85/85 [04:58<00:00,  3.51s/it, loss=0.00549]
Epoch 5/1000, Train Loss: 0.0055, Val Loss: 0.0055
Epoch 6/1000: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 85/85 [04:57<00:00,  3.50s/it, loss=0.00515]
Epoch 6/1000, Train Loss: 0.0052, Val Loss: 0.0051
Epoch 7/1000: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 85/85 [04:56<00:00,  3.48s/it, loss=0.005]
Epoch 7/1000, Train Loss: 0.0050, Val Loss: 0.0050
Epoch 8/1000: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 85/85 [04:55<00:00,  3.47s/it, loss=0.00486]
Epoch 8/1000, Train Loss: 0.0049, Val Loss: 0.0049
Epoch 9/1000: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 85/85 [04:55<00:00,  3.47s/it, loss=0.00482]
Epoch 9/1000, Train Loss: 0.0048, Val Loss: 0.0050
Epoch 10/1000: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 85/85 [04:54<00:00,  3.46s/it, loss=0.0047]
Epoch 10/1000, Train Loss: 0.0047, Val Loss: 0.0051
Epoch 11/1000: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 85/85 [04:56<00:00,  3.49s/it, loss=0.00464]
Epoch 11/1000, Train Loss: 0.0046, Val Loss: 0.0049
Epoch 12/1000: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 85/85 [04:55<00:00,  3.48s/it, loss=0.00453]
Epoch 12/1000, Train Loss: 0.0045, Val Loss: 0.0054
Epoch 13/1000: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 85/85 [04:54<00:00,  3.46s/it, loss=0.0045]
Epoch 13/1000, Train Loss: 0.0045, Val Loss: 0.0047
Epoch 14/1000: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 85/85 [04:55<00:00,  3.48s/it, loss=0.00442]
Epoch 14/1000, Train Loss: 0.0044, Val Loss: 0.0049
Epoch 15/1000: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 85/85 [04:54<00:00,  3.47s/it, loss=0.00429]
Epoch 15/1000, Train Loss: 0.0043, Val Loss: 0.0046
Epoch 16/1000: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 85/85 [04:54<00:00,  3.46s/it, loss=0.00421]
Epoch 16/1000, Train Loss: 0.0042, Val Loss: 0.0047
Epoch 17/1000: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 85/85 [04:55<00:00,  3.48s/it, loss=0.00411]
Epoch 17/1000, Train Loss: 0.0041, Val Loss: 0.0044
Epoch 18/1000: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 85/85 [04:56<00:00,  3.49s/it, loss=0.00403]
Epoch 18/1000, Train Loss: 0.0040, Val Loss: 0.0047
Epoch 19/1000: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 85/85 [04:53<00:00,  3.45s/it, loss=0.00397]
Epoch 19/1000, Train Loss: 0.0040, Val Loss: 0.0047
Epoch 20/1000: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 85/85 [04:55<00:00,  3.48s/it, loss=0.00388]
Epoch 20/1000, Train Loss: 0.0039, Val Loss: 0.0047
Epoch 21/1000: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 85/85 [04:54<00:00,  3.47s/it, loss=0.00378]
Epoch 21/1000, Train Loss: 0.0038, Val Loss: 0.0045
Epoch 22/1000: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 85/85 [04:55<00:00,  3.48s/it, loss=0.00373]
Epoch 22/1000, Train Loss: 0.0037, Val Loss: 0.0041
Epoch 23/1000: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 85/85 [04:53<00:00,  3.45s/it, loss=0.00368]
Epoch 23/1000, Train Loss: 0.0037, Val Loss: 0.0044
Epoch 24/1000: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 85/85 [04:54<00:00,  3.47s/it, loss=0.0036]
Epoch 24/1000, Train Loss: 0.0036, Val Loss: 0.0040
Epoch 25/1000: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 85/85 [04:54<00:00,  3.47s/it, loss=0.00355]
Epoch 25/1000, Train Loss: 0.0035, Val Loss: 0.0036
Epoch 26/1000: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 85/85 [04:55<00:00,  3.48s/it, loss=0.0035]
Epoch 26/1000, Train Loss: 0.0035, Val Loss: 0.0039
Epoch 27/1000: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 85/85 [04:56<00:00,  3.49s/it, loss=0.00344]
Epoch 27/1000, Train Loss: 0.0034, Val Loss: 0.0036
Epoch 28/1000: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 85/85 [04:54<00:00,  3.46s/it, loss=0.00342]
Epoch 28/1000, Train Loss: 0.0034, Val Loss: 0.0038
Epoch 29/1000: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 85/85 [04:54<00:00,  3.47s/it, loss=0.00338]
Epoch 29/1000, Train Loss: 0.0034, Val Loss: 0.0039
Epoch 30/1000: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 85/85 [04:54<00:00,  3.47s/it, loss=0.00335]
Epoch 30/1000, Train Loss: 0.0033, Val Loss: 0.0036
Epoch 31/1000: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 85/85 [04:57<00:00,  3.50s/it, loss=0.00332]
Epoch 31/1000, Train Loss: 0.0033, Val Loss: 0.0036
Epoch 32/1000: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 85/85 [04:55<00:00,  3.47s/it, loss=0.0033]
Epoch 32/1000, Train Loss: 0.0033, Val Loss: 0.0036
Epoch 33/1000: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 85/85 [04:56<00:00,  3.48s/it, loss=0.00327]
Traceback (most recent call last):
  File "/home/yunkwan/project/radarclip/Radarcap_main.py", line 285, in <module>
    main(args.train_1024, args.train_768, args.epochs, args.batch_size)
  File "/home/yunkwan/project/radarclip/Radarcap_main.py", line 253, in main
    train_model(encoder_search_resnet1D_1024, retrieval_model, train_loader, val_loader, criterion, optimizer, prepro_image_features_1024, num_epochs=num_epochs)
  File "/home/yunkwan/project/radarclip/Radarcap_main.py", line 208, in train_model
    images_features = prepro_image_fn(images, retrieval_model, device, batch_size=32)
  File "/home/yunkwan/project/radarclip/Radarcap_main.py", line 159, in prepro_image_features_1024
    torch.cuda.empty_cache()
  File "/home/yunkwan/anaconda3/envs/smallcap/lib/python3.9/site-packages/torch/cuda/memory.py", line 162, in empty_cache
    torch._C._cuda_emptyCache()
KeyboardInterrupt
