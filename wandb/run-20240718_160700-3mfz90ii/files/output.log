Some weights of the model checkpoint at google/vit-base-patch16-224 were not used when initializing ViTModel: ['classifier.bias', 'classifier.weight']
- This IS expected if you are initializing ViTModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing ViTModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of ViTModel were not initialized from the model checkpoint at google/vit-base-patch16-224 and are newly initialized: ['vit.pooler.dense.weight', 'vit.pooler.dense.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Epoch 1/50:   0%|                                                                                                                                                                                     | 0/750 [00:00<?, ?it/s]
[9] > [33;01m/home/yunkwan/project/radarclip/distillation.py[00m([36;01m350[00m)forward()
-> features = outputs.last_hidden_state.mean(dim=1)
BaseModelOutputWithPooling(last_hidden_state=tensor([[[-0.0618, -1.3593,  0.1304,  ...,  1.7851, -0.8237, -0.0099],
         [ 0.2255, -0.6862,  0.5556,  ...,  2.7070, -0.4152, -1.0709],
         [-0.4290, -0.9343,  0.4173,  ...,  2.0336, -0.1227, -0.8062],
         ...,
         [ 0.3131, -1.0814,  0.0856,  ...,  1.8296, -0.7581, -0.1556],
         [-0.7034, -0.4395, -0.7964,  ...,  1.6051, -0.4711, -0.4938],
         [ 0.1374, -0.3094, -0.0233,  ...,  1.1951, -0.1694, -0.5015]],

        [[ 0.1215, -1.5714,  0.8340,  ...,  0.8390, -0.8955,  0.3331],
         [ 0.0087, -1.2556,  1.5934,  ...,  0.7807, -0.7479, -0.5425],
         [-0.2240, -1.2672,  1.7585,  ...,  1.0628, -0.4971, -0.5738],
         ...,
         [-0.0321, -0.7776,  0.1693,  ...,  0.6185, -0.4886, -0.5595],
         [-0.2469, -0.7417,  0.9181,  ...,  0.7592, -0.4076, -0.5241],
         [ 0.2883, -0.3338, -0.1203,  ...,  0.6618, -0.1574, -0.6814]],

        [[-0.7215, -1.1887,  1.0184,  ...,  1.0970, -1.0421,  0.4358],
         [-0.5790, -1.0253,  1.2127,  ...,  2.0130, -0.6086, -0.7420],
         [-1.2038, -1.1248,  0.9503,  ...,  1.5685, -0.5621, -0.3747],
         ...,
         [-0.4468, -0.5447,  0.7446,  ...,  0.7475, -0.5901,  0.1126],
         [-0.7195, -0.1832,  0.8387,  ...,  1.2715, -0.4094,  0.0412],
         [-0.2519,  0.2992,  0.1618,  ...,  0.9506, -0.4462,  0.0576]],

        ...,

        [[ 0.9008, -1.4830,  0.6831,  ...,  0.2556, -0.6313,  0.0344],
         [-0.0094, -0.4630,  1.2394,  ...,  0.9526, -0.5416, -0.2327],
         [-0.5124, -0.7888,  1.2153,  ...,  1.1787, -0.6012, -0.3341],
         ...,
         [-0.2256, -0.1092,  0.4432,  ...,  0.7785, -0.7790, -0.6912],
         [ 0.0741, -0.3139,  0.2719,  ...,  0.8677, -0.5139, -0.5293],
         [ 0.3977,  0.0958,  0.0425,  ...,  0.5861, -0.1792, -0.3251]],

        [[ 0.7123, -1.4480,  0.1293,  ...,  2.0157, -1.4171,  0.0360],
         [ 0.8059, -1.5535,  1.2847,  ...,  1.6351, -1.1473, -0.0779],
         [-0.0161, -0.9177,  0.8084,  ...,  1.8145, -1.2817, -0.5707],
         ...,
         [ 0.8103, -1.3509,  0.2641,  ...,  1.4754, -1.3123, -0.8636],
         [ 0.6178, -1.1931,  0.6395,  ...,  1.3882, -1.2148, -0.9269],
         [ 1.3072, -1.2973,  0.5040,  ...,  1.1120, -1.4089, -0.1083]],

        [[ 0.0316, -1.5625,  0.6703,  ...,  1.0669, -1.1609,  0.4428],
         [ 0.3702, -1.4224,  0.9937,  ...,  1.3677, -0.9927, -0.5456],
         [-0.4385, -1.2019,  1.3784,  ...,  1.2250, -0.6494, -0.2609],
         ...,
         [ 0.0814, -1.1092,  0.5896,  ...,  1.1020, -1.3712, -0.3782],
         [-0.5309, -0.8004,  0.4896,  ...,  1.1665, -0.8482, -0.1734],
         [ 0.1388, -0.1251,  0.2839,  ...,  1.0190, -0.7517, -0.2144]]],
       device='cuda:0'), pooler_output=tensor([[-0.3863,  0.3419,  0.1744,  ..., -0.6641,  0.0820,  0.2898],
        [-0.3127,  0.2500,  0.0165,  ..., -0.7878,  0.3781,  0.4265],
        [-0.2768,  0.6383,  0.3690,  ..., -0.6451, -0.1019,  0.4793],
        ...,
        [-0.5062,  0.2356, -0.0573,  ..., -0.5636,  0.6612, -0.1498],
        [-0.0064,  0.7258,  0.2819,  ..., -0.1508, -0.4081,  0.1577],
        [-0.3506,  0.6307,  0.2092,  ..., -0.4531,  0.2824,  0.2472]],
       device='cuda:0'), hidden_states=None, attentions=None)
*** AttributeError: 'BaseModelOutputWithPooling' object has no attribute 'shape'
tensor([[[-0.0618, -1.3593,  0.1304,  ...,  1.7851, -0.8237, -0.0099],
         [ 0.2255, -0.6862,  0.5556,  ...,  2.7070, -0.4152, -1.0709],
         [-0.4290, -0.9343,  0.4173,  ...,  2.0336, -0.1227, -0.8062],
         ...,
         [ 0.3131, -1.0814,  0.0856,  ...,  1.8296, -0.7581, -0.1556],
         [-0.7034, -0.4395, -0.7964,  ...,  1.6051, -0.4711, -0.4938],
         [ 0.1374, -0.3094, -0.0233,  ...,  1.1951, -0.1694, -0.5015]],

        [[ 0.1215, -1.5714,  0.8340,  ...,  0.8390, -0.8955,  0.3331],
         [ 0.0087, -1.2556,  1.5934,  ...,  0.7807, -0.7479, -0.5425],
         [-0.2240, -1.2672,  1.7585,  ...,  1.0628, -0.4971, -0.5738],
         ...,
         [-0.0321, -0.7776,  0.1693,  ...,  0.6185, -0.4886, -0.5595],
         [-0.2469, -0.7417,  0.9181,  ...,  0.7592, -0.4076, -0.5241],
         [ 0.2883, -0.3338, -0.1203,  ...,  0.6618, -0.1574, -0.6814]],

        [[-0.7215, -1.1887,  1.0184,  ...,  1.0970, -1.0421,  0.4358],
         [-0.5790, -1.0253,  1.2127,  ...,  2.0130, -0.6086, -0.7420],
         [-1.2038, -1.1248,  0.9503,  ...,  1.5685, -0.5621, -0.3747],
         ...,
         [-0.4468, -0.5447,  0.7446,  ...,  0.7475, -0.5901,  0.1126],
         [-0.7195, -0.1832,  0.8387,  ...,  1.2715, -0.4094,  0.0412],
         [-0.2519,  0.2992,  0.1618,  ...,  0.9506, -0.4462,  0.0576]],

        ...,

        [[ 0.9008, -1.4830,  0.6831,  ...,  0.2556, -0.6313,  0.0344],
         [-0.0094, -0.4630,  1.2394,  ...,  0.9526, -0.5416, -0.2327],
         [-0.5124, -0.7888,  1.2153,  ...,  1.1787, -0.6012, -0.3341],
         ...,
         [-0.2256, -0.1092,  0.4432,  ...,  0.7785, -0.7790, -0.6912],
         [ 0.0741, -0.3139,  0.2719,  ...,  0.8677, -0.5139, -0.5293],
         [ 0.3977,  0.0958,  0.0425,  ...,  0.5861, -0.1792, -0.3251]],

        [[ 0.7123, -1.4480,  0.1293,  ...,  2.0157, -1.4171,  0.0360],
         [ 0.8059, -1.5535,  1.2847,  ...,  1.6351, -1.1473, -0.0779],
         [-0.0161, -0.9177,  0.8084,  ...,  1.8145, -1.2817, -0.5707],
         ...,
         [ 0.8103, -1.3509,  0.2641,  ...,  1.4754, -1.3123, -0.8636],
         [ 0.6178, -1.1931,  0.6395,  ...,  1.3882, -1.2148, -0.9269],
         [ 1.3072, -1.2973,  0.5040,  ...,  1.1120, -1.4089, -0.1083]],

        [[ 0.0316, -1.5625,  0.6703,  ...,  1.0669, -1.1609,  0.4428],
         [ 0.3702, -1.4224,  0.9937,  ...,  1.3677, -0.9927, -0.5456],
         [-0.4385, -1.2019,  1.3784,  ...,  1.2250, -0.6494, -0.2609],
         ...,
         [ 0.0814, -1.1092,  0.5896,  ...,  1.1020, -1.3712, -0.3782],
         [-0.5309, -0.8004,  0.4896,  ...,  1.1665, -0.8482, -0.1734],
         [ 0.1388, -0.1251,  0.2839,  ...,  1.0190, -0.7517, -0.2144]]],
       device='cuda:0')
torch.Size([32, 197, 768])
*** NameError: name 'features' is not defined
